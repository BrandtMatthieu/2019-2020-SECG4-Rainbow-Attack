# 2020-rainbow-attack

## gen-passwd

### Description
Generates the rainbow table.

**But this isn't a rainbow table, it's a simple hash table... why?**

A rainbow table is a simple hash table, except the result from the hash is passed to a reducing function to generate a new password to hash.

The thing is:
* the reducing function can be used any number of time, in this case it's 0, it still fits the definition tho
* the reducing function is hard to implement, since
    * it has to be designed to avoid generating a same password twice
    * or the programs needs to keep track of the password generated by the reducing function to not generate and hash them for the next entries, which is very hard to do
    * and I'm no crypto expert
* while less storage is required, more computation is needed, since
    * the reducing function needs to compute a new password,
    * and the hash to lookup in the table need to be reduced and rehashed a couple of time,
    * however, storage has become much cheaper these days, terabytes of data only cost a few dozen bucks,
    * while increasing the hash performance comes at a heavy costs

These are the reasons why this program only generates a simple hash table and no rainbow table.

**Hashing is slow, how can I improve performance?**

Multiple ways to improve performances would be:
* to use the GPU to compute the hashes
    * and use Nvidia CUDA cores
    * use OpenCl
* or to use the special SHA instructions on the modern Intel processors (7+nth gen required tho)
* to use a dedicated hashing processor (ASIC)

But all of this requires to know the exact hardware and software the program will be used on, and this is impossible.

**What about the performances of the program?**

Here are multiple ways to improve performances inside the program:
* putting `HASH_COUNT_PER_BUFFER` to a greater value
    * one hash is 32 + 1 + max password length bytes
    * this value is per hashing thread
    * it decreases disk calls
    * but increases RAM usage
    * also, if something happens and the program freezes, has to stop, the pc shuts down, this data is lost
* use more threads `--threads=4`
    * more performance
    * but more power consumption
    * OS might need more time to switch between threads if too many threads
    * number of logical CPU cores is recommended (often 4 or 8 these days, with Hyper Threading)

### Compiling
To compile the `gen-passwd` program, run

```sh
make
```
or
```
make build
```

### Running
Run
```
./gen-passwd
```
or
```
make run
```

More help will be displayed.

Program needs at least one argument to start.

### Options
```
--option=value

--help              Displays the help.
--hashes-file       The location of the file where the store the hashes. Default is './hashes.txt'.
--passwords-file    The location of the file where the store the passwords. Default is './passwords.txt'.
--min-pass-length   The minimum length of passwords to generate. Default is 1.
--max-pass-length   The maximum length of passwords to generate. Default is 6.
--max-file-size     The maximum length in bytes of the file containing the hashes. Default is 12000000 (12 GB).
--threads           The number of threads to use. Default is how many threads the system has. In this case as many as the system has.
--hashes-per-buffer The number of hashes to write to a buffer. Note this is a per-thread buffer and each hash is 33 bytes long. Default is 4000000 (4M hashes/buffer = 132MiB).
```
Options are separated by spaces.

Example:
```
./gen-passwd --hashes-file=generated-hashes.txt --passwords-file=generated-passwords.txt --max-pass-length=8 --threads=4 
```

### Tests

To run the tests, run
```
make test
```

To only build the tests, run
```
make build-test
```

### Valgrind

Valgrind is a set of tools.
One of them, memcheck, is used to check for memory leaks.

To run a memcheck on the program, run
```
make valgrind
```

To run a memcheck on the test suite, run
```
make valgrind-test
```

## check-passwd

### Description
Checks for a hash in the rainbow table.

### Compiling
This program doesn't need to be  compiled since it's a shell script.

Don't forget to make this script executable by running the command
```
chmod +x ./check-passwd
```

### Running
Run
```
./check-passwd
```

More help will be displayed.

Program needs at least one argument to start.

### Options

```
-ooption=value

-i  The hash to look for in the hashes list.
-l  The file containing all the hashes to look for. One per line. Default is 'list.txt'
-h  The file containing all the hashes generated. Default is 'hashes.txt'.
-p  The file containing all the passwords related to the hashes. Default is 'passwords.txt'.
```

Example:
```
./check-passwd -i=5feceb66ffc86f38d952786c6d696c79c2dbc239dd4e91b46729d73a27fb57e9 -h=generated-hashes.txt -p=generated-passwords.txt
```
